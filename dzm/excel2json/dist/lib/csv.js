var jschardet=require("./jschardet.min");function csvJson(a,i){var d="undefined"!=typeof FileReader&&void 0!==FileReader.prototype&&void 0!==FileReader.prototype.readAsBinaryString,e=new FileReader;e.onload=function(e){var r=e.target.result,s=null,n=null;if(d){for(var s=r,t=[],o=0;o<r.length;o++)t.push(r.charCodeAt(o));n=new Uint8Array(t)}else for(const o in n=new Uint8Array(r))if(s+=String.fromCharCode(n[o]),100<=o)break;e=jschardet.detect(s.substring(0,1e3)).encoding;if("GB2312"==e||"GB18030"==e)e="GB18030";else if("ascii"!=e&&"UTF-8"!=e&&"UTF-16BE"!=e&&"UTF-16LE"!=e)return void i(3);s=new TextDecoder(e).decode(n),handleJson(a,s,i)},d?e.readAsBinaryString(a):e.readAsArrayBuffer(a)}function handleJson(e,r,s){var n=e.name.split("."),e=e.name,n=(n.length&&(n.pop(),e=n.join("")),r.split("\n"));const t=[];n.forEach(e=>{e.length&&t.push(CSVtoArray(e))}),s(0,[{name:e,list:t}])}function CSVtoArray(e){var t;return/^\s*(?:'[^'\\]*(?:\\[\S\s][^'\\]*)*'|"[^"\\]*(?:\\[\S\s][^"\\]*)*"|[^,'"\s\\]*(?:\s+[^,'"\s\\]+)*)\s*(?:,\s*(?:'[^'\\]*(?:\\[\S\s][^'\\]*)*'|"[^"\\]*(?:\\[\S\s][^"\\]*)*"|[^,'"\s\\]*(?:\s+[^,'"\s\\]+)*)\s*)*$/.test(e)?(t=[],e.replace(/(?!\s*$)\s*(?:'([^'\\]*(?:\\[\S\s][^'\\]*)*)'|"([^"\\]*(?:\\[\S\s][^"\\]*)*)"|([^,'"\s\\]*(?:\s+[^,'"\s\\]+)*))\s*(?:,|$)/g,function(e,r,s,n){return void 0!==r?t.push(r.replace(/\\'/g,"'")):void 0!==s?t.push(s.replace(/\\"/g,'"')):void 0!==n&&t.push(n),""}),/,\s*$/.test(e)&&t.push(""),t):null}module.exports={csvJson:csvJson};